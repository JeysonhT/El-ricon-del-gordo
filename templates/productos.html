{% extends "base_Admin.html" %} {% block titulo %} Listado de Productos {%
endblock titulo %} {% block body %}
<div class="container mt-4">
  <div class="row">
    <div class="col-md-12">
      <h2 class="text-center mb-4">Listado de Productos</h2>
      <a
        href="{{ url_for('productos.agregar_producto') }}"
        class="btn btn-primary mb-3"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Añadir un nuevo producto al inventario."
        >Agregar Producto</a
      >
      <div class="table-responsive">
        <table
          id="productosTable"
          class="table table-striped table-bordered flex-column flex-md-row"
        >
          <thead class="thead-dark">
            <tr>
              <th scope="col">ID</th>
              <th scope="col">Nombre</th>
              <th scope="col">Categoria</th>
              <th scope="col">Cantidad</th>
              <th scope="col">Precio</th>
              <th scope="col">Fecha</th>
              <th scope="col">Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for producto in productos %}
            <tr>
              <td>{{ producto.id_producto }}</td>
              <td>{{ producto.nombre }}</td>
              <td>{{ producto.categoria }}</td>
              <td>{{ producto.cantidad }}</td>
              <td>${{ producto.precio }}</td>
              <td>{{ producto.fecha }}</td>
              <td>
                <a
                  href="{{ url_for('productos.editar_producto', id=producto.id_producto) }}"
                  class="btn btn-warning btn-sm"
                  data-bs-toggle="tooltip"
                  data-bs-placement="top"
                  title="Editar los detalles de este producto."
                  >Editar</a
                >
                <button
                  class="btn btn-danger btn-sm"
                  type="button"
                  data-bs-toggle="tooltip"
                  data-bs-placement="top"
                  title="Eliminar este producto del inventario."
                  onclick="confirmarEliminacion('{{ url_for('productos.eliminar_producto', id=producto.id_producto) }}')"
                >
                  Eliminar
                </button>
              </td>
            </tr>
            {% else %}
            <tr>
              <td colspan="6" class="text-center">
                No hay productos para mostrar.
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock body %} {% block scripts %}
<style>
  .dt-length {
    margin-bottom: 1rem;
    /* Ajusta este valor según tus preferencias */
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  $(document).ready(function () {
    $("#productosTable").DataTable({
      responsive: true,
      dom: "lBfrtip",
      buttons: [
        {
          extend: "excelHtml5",
          text: '<i class="fas fa-file-excel"></i> Excel',
          titleAttr: "Exportar a Excel",
          className: "btn btn-success",
        },
        {
          extend: "pdfHtml5",
          text: '<i class="fas fa-file-pdf"></i> PDF',
          titleAttr: "Exportar a PDF",
          className: "btn btn-danger",
        },
        {
          extend: "print",
          text: '<i class="fas fa-print"></i> Imprimir',
          titleAttr: "Imprimir",
          className: "btn btn-info",
        },
        {
          extend: "colvis",
          text: '<i class="fas fa-columns"></i> Columnas',
          titleAttr: "Visibilidad de Columnas",
          className: "btn btn-outline-dark",
        },
      ],
      language: {
        decimal: "",
        emptyTable: "No hay información",
        info: "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
        infoEmpty: "Mostrando 0 a 0 de 0 Entradas",
        infoFiltered: "(Filtrado de _MAX_ total entradas)",
        infoPostFix: "",
        thousands: ",",
        lengthMenu: "Mostrar _MENU_ Entradas",
        loadingRecords: "Cargando...",
        processing: "Procesando...",
        search: "Buscar:",
        zeroRecords: "Sin resultados encontrados",
        paginate: {
          first: "Primero",
          last: "Último",
          next: "Siguiente",
          previous: "Anterior",
        },
      },
    });
  });

  function confirmarEliminacion(url) {
    Swal.fire({
      title: "¿Estás seguro?",
      text: "¡No podrás revertir esto!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#d33",
      cancelButtonColor: "#3085d6",
      confirmButtonText: "Sí, eliminar",
      cancelButtonText: "Cancelar",
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = url;
      }
    });
  }
</script>

{% endblock %}
