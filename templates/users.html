{% extends "base_Admin.html" %} {% block titulo %}Lista de Usuarios{% endblock
%} {% block body %}
<div class="container mt-4">
  <div class="row">
    <div class="col-md-12">
      <h2 class="text-center mb-4">Lista de Usuarios</h2>
      <button id="crearUsuario" class="btn btn-primary mb-3" href="#" data-bs-toggle="tooltip" data-bs-placement="top" title="Abrir formulario para crear un nuevo usuario.">
        Crear usuario
      </button>
      <div class="table-responsive">
        <table id="usersTable" class="table table-striped table-bordered">
          <thead class="thead-dark">
            <tr>
              <th>ID</th>
              <th>Email</th>
              <th>Nombre</th>
              <th>Rol</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for user in users %}
            <tr>
              <td>{{ user.id_user }}</td>
              <td>{{ user.email }}</td>
              <td>{{ user.name }}</td>
              <td>{{ user.id_role }}</td>
              <td>
                <a
                  href="#"
                  class="btn btn-warning btn-sm edit-btn"
                  data-id="{{ user.id_user }}"
                  data-email="{{ user.email }}"
                  data-name="{{ user.name }}"
                  data-role="{{ user.id_role }}"
                  data-bs-toggle="tooltip" data-bs-placement="top" title="Editar los datos de este usuario."
                  >Editar</a
                >
                <form
                  id="delete-form-{{ user.id_user }}"
                  action="{{url_for('user.eliminar_usuario', id=user.id_user)}}"
                  method="POST"
                  style="display: inline"
                >
                  <button
                    type="button"
                    class="btn btn-danger btn-sm"
                    onclick="confirmDelete('{{ user.id_user }}')"
                    data-bs-toggle="tooltip" data-bs-placement="top" title="Eliminar este usuario."
                  >
                    Borrar
                  </button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div id="crearUsuarioModal" class="modal">
        <div id="modalContent" class="modal-content">
          <h2 id="modal-title">Crear Usuario</h2>
          <form
            id="modal-form"
            action="{{url_for('user.create_user')}}"
            method="POST"
          >
            <input type="hidden" id="user_id" name="user_id" />
            <label for="name">Nombre:</label>
            <input type="text" id="name" name="name" required data-bs-toggle="tooltip" data-bs-placement="top" title="Ingresa el nombre del usuario." />
            <br /><br />
            <label for="email">Correo:</label>
            <input type="email" id="email" name="email" required data-bs-toggle="tooltip" data-bs-placement="top" title="Ingresa el correo electrónico del usuario."/> <br /><br />
            <label for="password">Contraseña:</label>
            <input type="password" id="password" name="password" required data-bs-toggle="tooltip" data-bs-placement="top" title="Ingresa la contraseña para el usuario."/>
            <br /><br />
            <label for="role">Rol:</label>
            <select id="role" name="role" required data-bs-toggle="tooltip" data-bs-placement="top" title="Selecciona el rol del usuario.">
              <option value="1" selected>Usuario</option>
            </select>

            <input
              type="submit"
              id="submit-btn"
              value="Guardar Usuario"
              class="btn btn-success"
              data-bs-toggle="tooltip" data-bs-placement="bottom" title="Guardar los cambios."
            />
            <button
              type="button"
              id="cerrarModal"
              class="cerrar btn btn-danger mb-3"
              data-bs-toggle="tooltip" data-bs-placement="bottom" title="Cerrar sin guardar cambios."
            >
              Cerrar
            </button>
          </form>
        </div>
      </div>

      <!-- Modal de Confirmación de Eliminación -->
      <div id="deleteConfirmModal" class="modal">
        <div class="modal-content">
          <span class="cerrar-delete">&times;</span>
          <h2>Confirmar Eliminación</h2>
          <p>¿Estás seguro de que quieres eliminar este usuario?</p>
          <div class="modal-buttons">
            <button id="confirmDeleteBtn" class="btn btn-danger" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Confirmar la eliminación del usuario.">
              Eliminar
            </button>
            <button id="cancelDeleteBtn" class="btn btn-secondary" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Cancelar la eliminación.">
              Cancelar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  $(document).ready(function () {
    $("#usersTable").DataTable();
  });
</script>
<script
  type="text/javascript"
  charset="utf8"
  src="{{url_for('static', filename='js/UserModal.js')}}"
></script>
{% endblock %}
